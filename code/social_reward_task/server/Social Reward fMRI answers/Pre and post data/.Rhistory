SeparationAnxiety$scared_mf_31 <- ifelse(is.na(SeparationAnxiety$scared_mf_31), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_mf_31)
SeparationAnxiety$SepAnxsum <- rowSums(SeparationAnxiety[,c("scared_mf_4","scared_mf_8","scared_mf_13","scared_mf_16","scared_mf_20","scared_mf_25","scared_mf_29","scared_mf_31")],na.rm = TRUE)
SeparationAnxiety$SepAnxsum <- ifelse (SeparationAnxiety$SepAnxNA_count>3, NA, SeparationAnxiety$SepAnxsum)
SocialAnxiety <- c('scared_mf_3','scared_mf_10','scared_mf_26','scared_mf_32','scared_mf_39','scared_mf_40','scared_mf_41')
SocialAnxiety <- childscared[SocialAnxiety]
SocialAnxiety$SocAnxNA_count <- apply(SocialAnxiety,1,function(x)sum(is.na(x)))
SocialAnxiety$SocAnxmeans <- rowMeans(SocialAnxiety[,c("scared_mf_3","scared_mf_10","scared_mf_26","scared_mf_32","scared_mf_39","scared_mf_40","scared_mf_41")],na.rm = TRUE)
SocialAnxiety$scared_mf_3 <- ifelse(is.na(SocialAnxiety$scared_mf_3), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_3)
SocialAnxiety$scared_mf_10 <- ifelse(is.na(SocialAnxiety$scared_mf_10), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_10)
SocialAnxiety$scared_mf_26 <- ifelse(is.na(SocialAnxiety$scared_mf_26), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_26)
SocialAnxiety$scared_mf_32 <- ifelse(is.na(SocialAnxiety$scared_mf_32), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_32)
SocialAnxiety$scared_mf_39 <- ifelse(is.na(SocialAnxiety$scared_mf_39), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_39)
SocialAnxiety$scared_mf_40 <- ifelse(is.na(SocialAnxiety$scared_mf_40), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_40)
SocialAnxiety$scared_mf_41 <- ifelse(is.na(SocialAnxiety$scared_mf_41), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_mf_41)
SocialAnxiety$SocAnxsum <- rowSums(SocialAnxiety[,c("scared_mf_3","scared_mf_10","scared_mf_26","scared_mf_32","scared_mf_39","scared_mf_40","scared_mf_41")],na.rm = TRUE)
SocialAnxiety$SocAnxsum <- ifelse (SocialAnxiety$SocAnxNA_count>3, NA, SocialAnxiety$SocAnxsum)
SchoolAvoidance <- c('scared_mf_2','scared_mf_11','scared_mf_17','scared_mf_36')
SchoolAvoidance <- childscared[SchoolAvoidance]
SchoolAvoidance$SchAvoNA_count <- apply(SchoolAvoidance,1,function(x)sum(is.na(x)))
SchoolAvoidance$SchAvomeans <- rowMeans(SchoolAvoidance[,c("scared_mf_2","scared_mf_11","scared_mf_17","scared_mf_36")],na.rm = TRUE)
SchoolAvoidance$scared_mf_2 <- ifelse(is.na(SchoolAvoidance$scared_mf_2), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_mf_2)
SchoolAvoidance$scared_mf_11 <- ifelse(is.na(SchoolAvoidance$scared_mf_11), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_mf_11)
SchoolAvoidance$scared_mf_17 <- ifelse(is.na(SchoolAvoidance$scared_mf_17), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_mf_17)
SchoolAvoidance$scared_mf_36 <- ifelse(is.na(SchoolAvoidance$scared_mf_36), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_mf_36)
SchoolAvoidance$SchAvosum <- rowSums(SchoolAvoidance[,c("scared_mf_2","scared_mf_11","scared_mf_17","scared_mf_36")],na.rm = TRUE)
SchoolAvoidance$SchAvosum <- ifelse (SchoolAvoidance$SchAvoNA_count>1, NA, SchoolAvoidance$SchAvosum)
childFINAL <- cbind(childscared,SomaticPanic$SPsum,SomaticPanic$SPNA_count,GeneralizedAnxiety$GAsum,GeneralizedAnxiety$GANA_count,
SeparationAnxiety$SepAnxsum,SeparationAnxiety$SepAnxNA_count,SocialAnxiety$SocAnxsum,SocialAnxiety$SocAnxNA_count,
SchoolAvoidance$SchAvosum,SchoolAvoidance$SchAvoNA_count)
childFINAL$totalscared <- rowSums(childFINAL[,c("SomaticPanic$SPsum","GeneralizedAnxiety$GAsum","SeparationAnxiety$SepAnxsum","SocialAnxiety$SocAnxsum","SchoolAvoidance$SchAvosum")])
col_order <- c("record_id","SomaticPanic$SPsum","SomaticPanic$SPNA_count","GeneralizedAnxiety$GAsum","GeneralizedAnxiety$GANA_count","SeparationAnxiety$SepAnxsum","SeparationAnxiety$SepAnxNA_count","SocialAnxiety$SocAnxsum","SocialAnxiety$SocAnxNA_count","SchoolAvoidance$SchAvosum","SchoolAvoidance$SchAvoNA_count","totalscared","NA_count")
childSCAREDfinal <- childFINAL[,col_order]
names(childSCAREDfinal) <- c('record_id','SPsum','SPNA_count','GAsum','GANA_count','SepAnxsum','SepAnxNA_count','SocAnxsum','SocAnxNA_count','SchoAvosum','SchAvoNA_count','ScaredTotal','NA_count')
childSCAREDfinal$SPsum <- ifelse (childSCAREDfinal$NA_count>8, NA, childSCAREDfinal$SPsum)
childSCAREDfinal$GAsum <- ifelse (childSCAREDfinal$NA_count>8, NA, childSCAREDfinal$GAsum)
childSCAREDfinal$SepAnxsum <- ifelse (childSCAREDfinal$NA_count>8, NA, childSCAREDfinal$SepAnxsum)
childSCAREDfinal$SocAnxsum <- ifelse (childSCAREDfinal$NA_count>8, NA, childSCAREDfinal$SocAnxsum)
childSCAREDfinal$SchoAvosum <- ifelse (childSCAREDfinal$NA_count>8, NA, childSCAREDfinal$SchoAvosum)
childSCAREDfinal[is.na(childSCAREDfinal)] <- ""
y <- c("RED_CAT_124","RED_CAT_128","RED_CAT_129","RED_CAT_132","RED_CAT_133","RED_CAT_134","RED_CAT_135","RED_CAT_145","RED_CAT_146","RED_CAT_148","RED_CAT_149","RED_CAT_150","RED_CAT_151","RED_CAT_152","RED_CAT_156","RED_CAT_157",
"RED_CAT_163","RED_CAT_164","RED_CAT_168","RED_CAT_170","RED_CAT_173","RED_CAT_174","RED_CAT_182","RED_CAT_186","RED_CAT_187","RED_CAT_188","RED_CAT_189","RED_CAT_191","RED_CAT_193","RED_CAT_194","RED_CAT_195",
"RED_CAT_225","RED_CAT_229","RED_CAT_230","RED_CAT_234","RED_CAT_237","RED_CAT_238","RED_CAT_241","RED_CAT_242","RED_CAT_248","RED_CAT_251","RED_CAT_252","RED_CAT_253","RED_CAT_255",
"RED_CAT_256","RED_CAT_257","RED_CAT_258","RED_CAT_262","RED_CAT_264","RED_CAT_266","RED_CAT_270","RED_CAT_272","RED_CAT_274","RED_CAT_277","RED_CAT_279","RED_CAT_286","RED_CAT_287a","RED_CAT_291",
"RED_CAT_293","RED_CAT_295","RED_CAT_296","RED_CAT_297")
newchildscared <- childSCAREDfinal %>%
slice(match(y, record_id))
childsrq <- select(df, c(record_id,srq1,srq2,srq3,srq4,srq5,srq6,srq7,srq8,srq9,srq10,srq11,srq12,srq13,srq14,srq15,srq16,srq17,srq18,srq19,srq20,i_enjoysocial_reward_complete))
childsrq$NA_count <- apply(childsrq,1,function(x)sum(is.na(x)))
childsrq$i_enjoysocial_reward_complete <- ifelse (childsrq$NA_count>19, NA, childsrq$i_enjoysocial_reward_complete)
childsrq <- childsrq[complete.cases(childsrq[ , 22]),]
childsrq <- subset(childsrq, select = -c(i_enjoysocial_reward_complete))
Admiration <- c('srq1','srq7','srq10','srq16' )
Admiration <- childsrq[Admiration]
#Admiration$ID <- childsrq$Q4
Admiration$mean <- rowMeans((Admiration),na.rm=TRUE)
childsrq$Admiration <- Admiration$mean
#must be 1 or fewer NAs
Admiration$NA_count <- apply(Admiration,1,function(x)sum(is.na(x)))
childsrq$admirationNAcount <- Admiration$NA_count
#the following command will remove admiration score for participants with more than 50% data missing
childsrq$Admiration <- ifelse (childsrq$admirationNAcount>2, NA, childsrq$Admiration)
NegativeSocialPotency <- c('srq3','srq5','srq8','srq12', 'srq15')
NegativeSocialPotency <- childsrq[NegativeSocialPotency]
#NegativeSocialPotency$ID <- childsrq$Q4
NegativeSocialPotency$mean <- rowMeans((NegativeSocialPotency),na.rm=TRUE)
childsrq$NegativeSocialPotency <- NegativeSocialPotency$mean
#must be 2 or fewer NAs
NegativeSocialPotency$NA_count <- apply(NegativeSocialPotency,1,function(x)sum(is.na(x)))
childsrq$negsocpotNAcount <- NegativeSocialPotency$NA_count
#the following command will remove admiration score for participants with more than 50% data missing
childsrq$NegativeSocialPotency <- ifelse (childsrq$negsocpotNAcount>2, NA, childsrq$NegativeSocialPotency)
Passivity <- c('srq11','srq18','srq20')
Passivity <- childsrq[Passivity]
#Passivity$ID <- childsrq$Q4
Passivity$mean <- rowMeans((Passivity),na.rm=TRUE)
childsrq$Passivity <- Passivity$mean
#must be 1 or fewer NAs
Passivity$NA_count <- apply(Passivity,1,function(x)sum(is.na(x)))
childsrq$passNAcount <- Passivity$NA_count
#the following command will remove admiration score for participants with more than 50% data missing
childsrq$Passivity <- ifelse (childsrq$passNAcount>1, NA, childsrq$Passivity)
ProsocialInteraction <- c('srq2','srq6','srq14','srq17', 'srq19')
ProsocialInteraction <- childsrq[ProsocialInteraction]
#ProsocialInteraction$ID <- childsrq$Q4
ProsocialInteraction$mean <- rowMeans((ProsocialInteraction),na.rm=TRUE)
childsrq$ProsocialInteraction <- ProsocialInteraction$mean
#must be 2 or fewer NAs
ProsocialInteraction$NA_count <- apply(ProsocialInteraction,1,function(x)sum(is.na(x)))
childsrq$prosocNAcount <- ProsocialInteraction$NA_count
#the following command will remove admiration score for participants with more than 50% data missing
childsrq$ProsocialInteraction <- ifelse (childsrq$prosocNAcount>2, NA, childsrq$ProsocialInteraction)
Sociability <- c('srq4','srq9','srq13')
Sociability <- childsrq[Sociability]
#Sociability$ID <- childsrq$Q4
Sociability$mean <- rowMeans((Sociability),na.rm=TRUE)
childsrq$Sociability <- Sociability$mean
#must be 1 or fewer NAs
Sociability$NA_count <- apply(Sociability,1,function(x)sum(is.na(x)))
childsrq$socNAcount <- Sociability$NA_count
#the following command will remove admiration score for participants with more than 50% data missing
childsrq$Sociability <- ifelse (childsrq$socNAcount>1, NA, childsrq$Sociability)
data2 <- childsrq[c(1, 22:32)]
#delete participants with more than 20% of overall data missing
data2$Admiration <- ifelse (data2$NA_count>3, NA, data2$Admiration)
data2$NegativeSocialPotency <- ifelse (data2$NA_count>3, NA, data2$NegativeSocialPotency)
data2$Passivity <- ifelse (data2$NA_count>3, NA, data2$Passivity)
data2$ProsocialInteraction <- ifelse (data2$NA_count>3, NA, data2$ProsocialInteraction)
data2$Sociability <- ifelse (data2$NA_count>3, NA, data2$Sociability)
data2[is.na(data2)] <- ""
col_order <- c("record_id","Admiration","admirationNAcount","NegativeSocialPotency","negsocpotNAcount","Passivity","passNAcount","ProsocialInteraction","prosocNAcount","Sociability","socNAcount","NA_count")
SRQfinal <- data2[,col_order]
z <- c("RED_CAT_124","RED_CAT_128","RED_CAT_129","RED_CAT_132","RED_CAT_133","RED_CAT_134","RED_CAT_135","RED_CAT_145","RED_CAT_146","RED_CAT_148","RED_CAT_149","RED_CAT_150","RED_CAT_151","RED_CAT_152","RED_CAT_156","RED_CAT_157",
"RED_CAT_163","RED_CAT_164","RED_CAT_168","RED_CAT_170","RED_CAT_173","RED_CAT_174","RED_CAT_182","RED_CAT_186","RED_CAT_187","RED_CAT_188","RED_CAT_189","RED_CAT_191","RED_CAT_193","RED_CAT_194","RED_CAT_195",
"RED_CAT_225","RED_CAT_229","RED_CAT_230","RED_CAT_234","RED_CAT_237","RED_CAT_238","RED_CAT_241","RED_CAT_242","RED_CAT_248","RED_CAT_251","RED_CAT_252","RED_CAT_253","RED_CAT_255",
"RED_CAT_256","RED_CAT_257","RED_CAT_258","RED_CAT_262","RED_CAT_264","RED_CAT_266","RED_CAT_270","RED_CAT_272","RED_CAT_274","RED_CAT_277","RED_CAT_279","RED_CAT_286","RED_CAT_287a","RED_CAT_291",
"RED_CAT_293","RED_CAT_295","RED_CAT_296","RED_CAT_297")
newsrq <- SRQfinal %>%
slice(match(z, record_id))
parentscared <- select(df2, c(record_id,scared_01,scared_02,scared_03,scared_04,scared_05,scared_06,scared_07,scared_08,scared_09,scared_10,scared_11,scared_12,scared_13,scared_14,scared_15,scared_16,scared_17,
scared_18,scared_19,scared_20,scared_21,scared_22,scared_23,scared_24,scared_25,scared_26,scared_27,scared_28,scared_29,scared_30,scared_31,scared_32,scared_33,scared_34,scared_35,scared_36,
scared_37,scared_38,scared_39,scared_40,scared_41,scared_parent_report_complete))
parentscared$NA_count <- apply(parentscared,1,function(x)sum(is.na(x)))
parentscared$scared_parent_report_complete <- ifelse (parentscared$NA_count>40, NA, parentscared$scared_parent_report_complete)
parentscared <- parentscared[complete.cases(parentscared[ , 43]),]
SomaticPanic <- c('scared_01','scared_06','scared_09','scared_12','scared_15','scared_18','scared_19','scared_22','scared_24','scared_27','scared_30','scared_34','scared_38')
SomaticPanic <- parentscared[SomaticPanic]
SomaticPanic$SPNA_count <- apply(SomaticPanic,1,function(x)sum(is.na(x)))
SomaticPanic$SPmeans <- rowMeans(SomaticPanic[,c("scared_01","scared_06","scared_09","scared_12","scared_15","scared_18","scared_19","scared_22","scared_24","scared_27","scared_30","scared_34","scared_38")],na.rm=TRUE)
SomaticPanic$scared_01 <- ifelse(is.na(SomaticPanic$scared_01), SomaticPanic$SPmeans, SomaticPanic$scared_01)
SomaticPanic$scared_06 <- ifelse(is.na(SomaticPanic$scared_06), SomaticPanic$SPmeans, SomaticPanic$scared_06)
SomaticPanic$scared_09 <- ifelse(is.na(SomaticPanic$scared_09), SomaticPanic$SPmeans, SomaticPanic$scared_09)
SomaticPanic$scared_12 <- ifelse(is.na(SomaticPanic$scared_12), SomaticPanic$SPmeans, SomaticPanic$scared_12)
SomaticPanic$scared_15 <- ifelse(is.na(SomaticPanic$scared_15), SomaticPanic$SPmeans, SomaticPanic$scared_15)
SomaticPanic$scared_18 <- ifelse(is.na(SomaticPanic$scared_18), SomaticPanic$SPmeans, SomaticPanic$scared_18)
SomaticPanic$scared_19 <- ifelse(is.na(SomaticPanic$scared_19), SomaticPanic$SPmeans, SomaticPanic$scared_19)
SomaticPanic$scared_22 <- ifelse(is.na(SomaticPanic$scared_22), SomaticPanic$SPmeans, SomaticPanic$scared_22)
SomaticPanic$scared_24 <- ifelse(is.na(SomaticPanic$scared_24), SomaticPanic$SPmeans, SomaticPanic$scared_24)
SomaticPanic$scared_27 <- ifelse(is.na(SomaticPanic$scared_27), SomaticPanic$SPmeans, SomaticPanic$scared_27)
SomaticPanic$scared_30 <- ifelse(is.na(SomaticPanic$scared_30), SomaticPanic$SPmeans, SomaticPanic$scared_30)
SomaticPanic$scared_34 <- ifelse(is.na(SomaticPanic$scared_34), SomaticPanic$SPmeans, SomaticPanic$scared_34)
SomaticPanic$scared_38 <- ifelse(is.na(SomaticPanic$scared_38), SomaticPanic$SPmeans, SomaticPanic$scared_38)
SomaticPanic$SPsum <- rowSums(SomaticPanic[,c("scared_01","scared_06","scared_09","scared_12","scared_15","scared_18","scared_19","scared_22","scared_24","scared_27","scared_30","scared_34","scared_38")],na.rm=TRUE)
SomaticPanic$SPsum <- ifelse (SomaticPanic$SPNA_count>6, NA, SomaticPanic$SPsum)
GeneralizedAnxiety <- c('scared_05','scared_07','scared_14','scared_21','scared_23','scared_28','scared_33','scared_35','scared_37')
GeneralizedAnxiety <- parentscared[GeneralizedAnxiety]
GeneralizedAnxiety$GANA_count <- apply(GeneralizedAnxiety,1,function(x)sum(is.na(x)))
GeneralizedAnxiety$GAmeans <- rowMeans(GeneralizedAnxiety[,c("scared_05","scared_07","scared_14","scared_21","scared_23","scared_28","scared_33","scared_35","scared_37")],na.rm = TRUE)
GeneralizedAnxiety$scared_05 <- ifelse(is.na(GeneralizedAnxiety$scared_05), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_05)
GeneralizedAnxiety$scared_07 <- ifelse(is.na(GeneralizedAnxiety$scared_07), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_07)
GeneralizedAnxiety$scared_14 <- ifelse(is.na(GeneralizedAnxiety$scared_14), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_14)
GeneralizedAnxiety$scared_21 <- ifelse(is.na(GeneralizedAnxiety$scared_21), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_21)
GeneralizedAnxiety$scared_23 <- ifelse(is.na(GeneralizedAnxiety$scared_23), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_23)
GeneralizedAnxiety$scared_28 <- ifelse(is.na(GeneralizedAnxiety$scared_28), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_28)
GeneralizedAnxiety$scared_33 <- ifelse(is.na(GeneralizedAnxiety$scared_33), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_33)
GeneralizedAnxiety$scared_35 <- ifelse(is.na(GeneralizedAnxiety$scared_35), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_35)
GeneralizedAnxiety$scared_37 <- ifelse(is.na(GeneralizedAnxiety$scared_37), GeneralizedAnxiety$GAmeans, GeneralizedAnxiety$scared_37)
GeneralizedAnxiety$GAsum <- rowSums(GeneralizedAnxiety[,c("scared_05","scared_07","scared_14","scared_21","scared_23","scared_28","scared_33","scared_35","scared_37")],na.rm = TRUE)
GeneralizedAnxiety$GAsum <- ifelse (GeneralizedAnxiety$GANA_count>4, NA, GeneralizedAnxiety$GAsum)
SeparationAnxiety <- c('scared_04','scared_08','scared_13','scared_16','scared_20','scared_25','scared_29','scared_31')
SeparationAnxiety <- parentscared[SeparationAnxiety]
SeparationAnxiety$SepAnxNA_count <- apply(SeparationAnxiety,1,function(x)sum(is.na(x)))
SeparationAnxiety$SepAnxmeans <- rowMeans(SeparationAnxiety[,c("scared_04","scared_08","scared_13","scared_16","scared_20","scared_25","scared_29","scared_31")],na.rm = TRUE)
SeparationAnxiety$scared_04 <- ifelse(is.na(SeparationAnxiety$scared_04), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_04)
SeparationAnxiety$scared_08 <- ifelse(is.na(SeparationAnxiety$scared_08), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_08)
SeparationAnxiety$scared_13 <- ifelse(is.na(SeparationAnxiety$scared_13), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_13)
SeparationAnxiety$scared_16 <- ifelse(is.na(SeparationAnxiety$scared_16), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_16)
SeparationAnxiety$scared_20 <- ifelse(is.na(SeparationAnxiety$scared_20), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_20)
SeparationAnxiety$scared_25 <- ifelse(is.na(SeparationAnxiety$scared_25), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_25)
SeparationAnxiety$scared_29 <- ifelse(is.na(SeparationAnxiety$scared_29), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_29)
SeparationAnxiety$scared_31 <- ifelse(is.na(SeparationAnxiety$scared_31), SeparationAnxiety$SepAnxmeans, SeparationAnxiety$scared_31)
SeparationAnxiety$SepAnxsum <- rowSums(SeparationAnxiety[,c("scared_04","scared_08","scared_13","scared_16","scared_20","scared_25","scared_29","scared_31")],na.rm = TRUE)
SeparationAnxiety$SepAnxsum <- ifelse (SeparationAnxiety$SepAnxNA_count>3, NA, SeparationAnxiety$SepAnxsum)
SocialAnxiety <- c('scared_03','scared_10','scared_26','scared_32','scared_39','scared_40','scared_41')
SocialAnxiety <- parentscared[SocialAnxiety]
SocialAnxiety$SocAnxNA_count <- apply(SocialAnxiety,1,function(x)sum(is.na(x)))
SocialAnxiety$SocAnxmeans <- rowMeans(SocialAnxiety[,c("scared_03","scared_10","scared_26","scared_32","scared_39","scared_40","scared_41")],na.rm = TRUE)
SocialAnxiety$scared_03 <- ifelse(is.na(SocialAnxiety$scared_03), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_03)
SocialAnxiety$scared_10 <- ifelse(is.na(SocialAnxiety$scared_10), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_10)
SocialAnxiety$scared_26 <- ifelse(is.na(SocialAnxiety$scared_26), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_26)
SocialAnxiety$scared_32 <- ifelse(is.na(SocialAnxiety$scared_32), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_32)
SocialAnxiety$scared_39 <- ifelse(is.na(SocialAnxiety$scared_39), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_39)
SocialAnxiety$scared_40 <- ifelse(is.na(SocialAnxiety$scared_40), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_40)
SocialAnxiety$scared_41 <- ifelse(is.na(SocialAnxiety$scared_41), SocialAnxiety$SocAnxmeans, SocialAnxiety$scared_41)
SocialAnxiety$SocAnxsum <- rowSums(SocialAnxiety[,c("scared_03","scared_10","scared_26","scared_32","scared_39","scared_40","scared_41")],na.rm = TRUE)
SocialAnxiety$SocAnxsum <- ifelse (SocialAnxiety$SocAnxNA_count>3, NA, SocialAnxiety$SocAnxsum)
SchoolAvoidance <- c('scared_02','scared_11','scared_17','scared_36')
SchoolAvoidance <- parentscared[SchoolAvoidance]
SchoolAvoidance$SchAvoNA_count <- apply(SchoolAvoidance,1,function(x)sum(is.na(x)))
SchoolAvoidance$SchAvomeans <- rowMeans(SchoolAvoidance[,c("scared_02","scared_11","scared_17","scared_36")],na.rm = TRUE)
SchoolAvoidance$scared_02 <- ifelse(is.na(SchoolAvoidance$scared_02), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_02)
SchoolAvoidance$scared_11 <- ifelse(is.na(SchoolAvoidance$scared_11), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_11)
SchoolAvoidance$scared_17 <- ifelse(is.na(SchoolAvoidance$scared_17), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_17)
SchoolAvoidance$scared_36 <- ifelse(is.na(SchoolAvoidance$scared_36), SchoolAvoidance$SchAvomeans, SchoolAvoidance$scared_36)
SchoolAvoidance$SchAvosum <- rowSums(SchoolAvoidance[,c("scared_02","scared_11","scared_17","scared_36")],na.rm = TRUE)
SchoolAvoidance$SchAvosum <- ifelse (SchoolAvoidance$SchAvoNA_count>1, NA, SchoolAvoidance$SchAvosum)
parentSCAREDfinal <- cbind(parentscared,SomaticPanic$SPsum,SomaticPanic$SPNA_count,GeneralizedAnxiety$GAsum,GeneralizedAnxiety$GANA_count,SeparationAnxiety$SepAnxsum,SeparationAnxiety$SepAnxNA_count,SocialAnxiety$SocAnxsum,SocialAnxiety$SocAnxNA_count,SchoolAvoidance$SchAvosum,SchoolAvoidance$SchAvoNA_count)
parentSCAREDfinal$totalscared <- rowSums(parentSCAREDfinal[,c("SomaticPanic$SPsum","GeneralizedAnxiety$GAsum","SeparationAnxiety$SepAnxsum","SocialAnxiety$SocAnxsum","SchoolAvoidance$SchAvosum")])
col_order <- c("record_id","SomaticPanic$SPsum","SomaticPanic$SPNA_count","GeneralizedAnxiety$GAsum","GeneralizedAnxiety$GANA_count","SeparationAnxiety$SepAnxsum","SeparationAnxiety$SepAnxNA_count","SocialAnxiety$SocAnxsum","SocialAnxiety$SocAnxNA_count","SchoolAvoidance$SchAvosum","SchoolAvoidance$SchAvoNA_count","totalscared","NA_count")
newparentSCAREDfinal <- parentSCAREDfinal[,col_order]
names(newparentSCAREDfinal) <- c('record_id','SPsum','SPNA_count','GAsum','GANA_count','SepAnxsum','SepAnxNA_count','SocAnxsum','SocAnxNA_count','SchoAvosum','SchAvoNA_count','totalscared','NA_count')
#delete participants with 205 or more missing values
newparentSCAREDfinal$SPsum <- ifelse (newparentSCAREDfinal$NA_count>8, NA, newparentSCAREDfinal$SPsum)
newparentSCAREDfinal$GAsum <- ifelse (newparentSCAREDfinal$NA_count>8, NA, newparentSCAREDfinal$GAsum)
newparentSCAREDfinal$SepAnxsum <- ifelse (newparentSCAREDfinal$NA_count>8, NA, newparentSCAREDfinal$SepAnxsum)
newparentSCAREDfinal$SocAnxsum <- ifelse (newparentSCAREDfinal$NA_count>8, NA, newparentSCAREDfinal$SocAnxsum)
newparentSCAREDfinal$SchoAvosum <- ifelse (newparentSCAREDfinal$NA_count>8, NA, newparentSCAREDfinal$SchoAvosum)
newparentSCAREDfinal[is.na(newparentSCAREDfinal)] <- ""
a <- c("RED_CAT_124","RED_CAT_128","RED_CAT_129","RED_CAT_132","RED_CAT_133","RED_CAT_134","RED_CAT_135","RED_CAT_145","RED_CAT_146","RED_CAT_148","RED_CAT_149","RED_CAT_150","RED_CAT_151","RED_CAT_152","RED_CAT_156","RED_CAT_157",
"RED_CAT_163","RED_CAT_164","RED_CAT_168","RED_CAT_170","RED_CAT_173","RED_CAT_174","RED_CAT_182","RED_CAT_186","RED_CAT_187","RED_CAT_188","RED_CAT_189","RED_CAT_191","RED_CAT_193","RED_CAT_194","RED_CAT_195",
"RED_CAT_225","RED_CAT_229","RED_CAT_230","RED_CAT_234","RED_CAT_237","RED_CAT_238","RED_CAT_241","RED_CAT_242","RED_CAT_248","RED_CAT_251","RED_CAT_252","RED_CAT_253","RED_CAT_255",
"RED_CAT_256","RED_CAT_257","RED_CAT_258","RED_CAT_262","RED_CAT_264","RED_CAT_266","RED_CAT_270","RED_CAT_272","RED_CAT_274","RED_CAT_277","RED_CAT_279","RED_CAT_286a","RED_CAT_287","RED_CAT_291",
"RED_CAT_293","RED_CAT_295","RED_CAT_296","RED_CAT_297")
newparentSCARED <- newparentSCAREDfinal %>%
slice(match(a, record_id))
newparentSCARED$record_id <- gsub("RED_CAT_286a", "RED_CAT_286", newparentSCARED$record_id)
newparentSCARED$record_id <- gsub("RED_CAT_287", "RED_CAT_287a", newparentSCARED$record_id)
cbcl <- select(df2, c(1:163))
#convert likert scale from 1,2,3 to 0,1,2
for(i in 2:ncol(cbcl))
{
for (j in 1:nrow(cbcl))
{
if (is.na(cbcl[j, i])){
cbcl[j,i] = -999
}
else{
if(cbcl[j,i] == 1){
cbcl[j,i] = 0
}
if(cbcl[j,i] == 2){
cbcl[j,i] = 1
}
if (cbcl[j,i] == 3){
cbcl[j,i] = 2
}
}
}
}
#identify NA values
cbclNEW = na_if(cbcl,-999)
cbclNEW$NA_count <- apply(cbclNEW,1,function(x)sum(is.na(x)))
cbclNEW$cbcl_complete <- ifelse (cbclNEW$NA_count>134, NA, cbclNEW$cbcl_complete)
cbclNEW <- cbclNEW[complete.cases(cbclNEW[ , 163]),]
#check if any are missing more than 8 problem items
practice <- subset(cbclNEW, select = -c(cbcl1_2_text,cbcl1_9_text,cbcl1_29_text,cbcl1_40_text,cbcl1_46_text,cbcl1_56_d_text,cbcl_56_h_text,cbcl1_58_text,cbcl1_66_text,cbcl1_70_text,cbcl1_73_text,cbcl1_77_text,cbcl1_79_text,cbcl1_83_text,cbcl1_84_text,cbcl1_85_text,cbcl1_92_text,cbcl1_100_text,cbcl1_105_text,cbcl1_113_a_text,
cbcl1_113_b_text,cbcl1_113_c_text,school_services,cbcl4_2_text,cbcl3_1a,cbcl4_3_a_text,cbcl4_3_b_text,cbcl4_c,cbcl4_3_d_text,cbcl1_113_a,cbcl1_113_b,cbcl1_113_c))
practice$NA_count <- apply(practice,1,function(x)sum(is.na(x)))
#attempt to delete rows but having a hard time
correctCBCL <-cbclNEW[!(cbclNEW$record_id=="RED_CAT_243" | cbclNEW$record_id=="RED_CHT_ASD_166" | cbclNEW$record_id=="RED_CHT_ASD_175" | cbclNEW$record_id=="RED_CHT_ASD_202" | cbclNEW$record_id=="RED_RL_107--2" | cbclNEW$record_id=="RED_RL_121--1" | cbclNEW$record_id=="RED_RL_121--2"),]
anxiousdepressed <- select(correctCBCL, c(record_id,cbcl1_14,cbcl1_29,cbcl1_29_text,cbcl1_30,cbcl1_31,cbcl1_32,cbcl1_33,cbcl1_35,cbcl1_45,cbcl1_50,cbcl1_52,
cbcl1_71,cbcl1_91,cbcl1_112))
anxiousdepressed$anxiousdepressedscore <- rowMeans(anxiousdepressed[,c("cbcl1_14","cbcl1_29","cbcl1_30","cbcl1_31","cbcl1_32","cbcl1_33","cbcl1_35","cbcl1_45","cbcl1_50","cbcl1_52", "cbcl1_71","cbcl1_91","cbcl1_112")], na.rm=TRUE)
anxiousdepressed$NA_count <- apply(anxiousdepressed,1,function(x)sum(is.na(x)))
withdrawndepressed <- select(correctCBCL, c(record_id,cbcl1_5,cbcl1_42,cbcl1_65,cbcl1_69,cbcl1_75,cbcl1_102,cbcl1_103,cbcl1_111))
withdrawndepressed$NA_count <- apply(withdrawndepressed,1,function(x)sum(is.na(x)))
withdrawndepressed$withdrawndepressedscore <- rowMeans(withdrawndepressed[,c("cbcl1_5","cbcl1_42","cbcl1_65","cbcl1_69","cbcl1_75","cbcl1_102","cbcl1_103","cbcl1_111")], na.rm=TRUE)
#withdrawndepressed[is.na(withdrawndepressed)] <- ""
somaticcomplaints <- select(correctCBCL, c(record_id,cbcl1_47,cbcl1_49,cbcl1_51,cbcl1_54,cbcl1_56_a,cbcl1_56_b,cbcl1_56_c,cbcl1_56_d,cbcl1_56_e,cbcl1_56_f,cbcl1_56_g))
somaticcomplaints$NA_count <- apply(somaticcomplaints,1,function(x)sum(is.na(x)))
somaticcomplaints$somaticcomplaintsscore <- rowMeans(somaticcomplaints[,c("cbcl1_47","cbcl1_49","cbcl1_51","cbcl1_54","cbcl1_56_a","cbcl1_56_b","cbcl1_56_c","cbcl1_56_d","cbcl1_56_e","cbcl1_56_f","cbcl1_56_g")], na.rm=TRUE)
internalizingsubscale <- cbind(anxiousdepressed,withdrawndepressed,somaticcomplaints)
internalizingsubscale$internalizingscore <-rowMeans(internalizingsubscale[,c("cbcl1_14","cbcl1_29","cbcl1_30","cbcl1_31","cbcl1_32","cbcl1_33","cbcl1_35","cbcl1_45","cbcl1_50","cbcl1_52", "cbcl1_71","cbcl1_91","cbcl1_112",
"cbcl1_5","cbcl1_42","cbcl1_65","cbcl1_69","cbcl1_75","cbcl1_102","cbcl1_103","cbcl1_111","cbcl1_47","cbcl1_49","cbcl1_51","cbcl1_54","cbcl1_56_a","cbcl1_56_b","cbcl1_56_c","cbcl1_56_d","cbcl1_56_e","cbcl1_56_f","cbcl1_56_g")], na.rm=TRUE)
trythis <- cbind(correctCBCL,anxiousdepressed$anxiousdepressedscore,withdrawndepressed$withdrawndepressedscore,somaticcomplaints$somaticcomplaintsscore,internalizingsubscale$internalizingscore)
example <- c("RED_CAT_124","RED_CAT_128","RED_CAT_129","RED_CAT_132","RED_CAT_133","RED_CAT_134","RED_CAT_135","RED_CAT_145","RED_CAT_146","RED_CAT_148","RED_CAT_149","RED_CAT_150","RED_CAT_151","RED_CAT_152","RED_CAT_156","RED_CAT_157",
"RED_CAT_163","RED_CAT_164","RED_CAT_168","RED_CAT_170","RED_CAT_173","RED_CAT_174","RED_CAT_182","RED_CAT_186","RED_CAT_187","RED_CAT_188","RED_CAT_189","RED_CAT_191","RED_CAT_193","RED_CAT_194","RED_CAT_195",
"RED_CAT_225","RED_CAT_229","RED_CAT_230","RED_CAT_234","RED_CAT_237","RED_CAT_238","RED_CAT_241","RED_CAT_242","RED_CAT_248","RED_CAT_251","RED_CAT_252","RED_CAT_253","RED_CAT_255",
"RED_CAT_256","RED_CAT_257","RED_CAT_258","RED_CAT_262","RED_CAT_264","RED_CAT_266","RED_CAT_270","RED_CAT_272","RED_CAT_274","RED_CAT_277","RED_CAT_279","RED_CAT_286a","RED_CAT_287","RED_CAT_291",
"RED_CAT_293","RED_CAT_295","RED_CAT_296","RED_CAT_297")
dataframecbcl <- trythis %>%
slice(match(example, record_id))
dataframecbcl$record_id <- gsub("RED_CAT_286a", "RED_CAT_286", dataframecbcl$record_id)
dataframecbcl$record_id <- gsub("RED_CAT_287", "RED_CAT_287a", dataframecbcl$record_id)
almost <-cbind(newchildloneliness$record_id, newchildloneliness$dissimilarity, newchildloneliness$loneliness,newchildscared$SPsum, newchildscared$GAsum, newchildscared$SepAnxsum, newchildscared$SocAnxsum,
newchildscared$SchoAvosum, newchildscared$ScaredTotal, newsrq$Admiration, newsrq$NegativeSocialPotency, newsrq$Passivity, newsrq$ProsocialInteraction, newsrq$Sociability, newparentSCARED$SPsum, newparentSCARED$GAsum,
newparentSCARED$SepAnxsum, newparentSCARED$SocAnxsum, newparentSCARED$SchoAvosum, newparentSCARED$totalscared, dataframecbcl$`anxiousdepressed$anxiousdepressedscore`, dataframecbcl$`withdrawndepressed$withdrawndepressedscore`, dataframecbcl$`somaticcomplaints$somaticcomplaintsscore`,
dataframecbcl$`internalizingsubscale$internalizingscore`)
FINAL <- as.data.frame(almost)
names(FINAL) <- c('record_id','dissimilarity','loneliness','somaticpanic','generalanxiety','separationanxiety','socialanxiety','schoolanxiety',
'childtotalscared','srqAdmiration','srqNegativeSocialPotency','srqPassivity','srqProsocialInteraction','srqSociability', 'parentSP','parentGA',
'parentSepAnx','parentSocAnx','parentSchAnx','parenttotalscared','anxiousdepressed','withdrawndepressed','somaticcomplaints','internalizingscore')
write.csv(FINAL,"C:\\Users\\pmunshell\\Desktop\\DSCN\\FINALinsar.csv", row.names = FALSE)
data <- read.csv("usethis.csv")
View(data)
TD <- data[1:31, ]
tds <- dplyr::pull(TD, 5)
TDdissimilarity <- as.numeric(tds)
tdl <-dplyr::pull(TD, 6)
TDloneliness <- as.numeric(tdl)
tdsp <- dplyr::pull(TD, 7)
TDsomaticpanic <- as.numeric(tdsp)
tdga<- dplyr::pull(TD, 8)
TDgeneralanxiety <- as.numeric(tdga)
tdsepa <- dplyr::pull(TD, 9)
TDseparationanxiety <- as.numeric(tdsepa)
tdsocanx <- dplyr::pull(TD, 10)
TDsocialanxiety <- as.numeric(tdsocanx)
tdschanx <- dplyr::pull(TD, 11)
TDschoolanxiety <- as.numeric(tdschanx)
tdtotalscared <- dplyr::pull(TD, 12)
TDtotalscared <- as.numeric(tdtotalscared)
tdadmir <- dplyr::pull(TD, 13)
TDadmiration <- as.numeric(tdadmir)
tdnsp <- dplyr::pull(TD, 14)
TDnegativesocialpotency <- as.numeric(tdnsp)
tdpass <- dplyr::pull(TD, 15)
TDpassivity <- as.numeric(tdpass)
tdpro <- dplyr::pull(TD, 16)
TDprosocial <- as.numeric(tdpro)
tdsoc <- dplyr::pull(TD, 17)
TDsociability <- as.numeric(tdsoc)
tdpsp <- dplyr::pull(TD, 18)
TDparentSP <- as.numeric(tdpsp)
tdpga <- dplyr::pull(TD, 19)
TDparentGA <- as.numeric(tdpga)
tdpsepanx <-dplyr::pull(TD, 20)
TDparentSEPANX <- as.numeric(tdpsepanx)
tdpsocanx <- dplyr::pull(TD, 21)
TDparentSOCANX <- as.numeric(tdpsocanx)
tdpschanx <- dplyr::pull(TD, 22)
TDparentSCHANX <- as.numeric(tdpschanx)
tdparenttotalscared <- dplyr::pull(TD, 23)
TDparenttotalscared <- as.numeric(tdparenttotalscared)
tdad <- dplyr::pull(TD, 24)
TDanxiousdepressed <- as.numeric(tdad)
tdwd <- dplyr::pull(TD, 25)
TDwithdrawndepressed <- as.numeric(tdwd)
tdsc <- dplyr::pull(TD, 26)
TDsomaticcomplaints <- as.numeric(tdsc)
tdis <- dplyr::pull(TD, 27)
TDinternalizingscore <- as.numeric(tdis)
ASD <- data[32:62, ]
asdd <- dplyr::pull(ASD, 5)
ASDdissimilarity <- as.numeric(asdd)
asdl <- dplyr::pull(ASD, 6)
ASDloneliness <- as.numeric(asdl)
asdsp <- dplyr::pull(ASD, 7)
ASDsomaticpanic <- as.numeric(asdsp)
asdga<- dplyr::pull(ASD, 8)
ASDgeneralanxiety <- as.numeric(asdga)
asdsepa <- dplyr::pull(ASD, 9)
ASDseparationanxiety <- as.numeric(asdsepa)
asdsocanx <- dplyr::pull(ASD, 10)
ASDsocialanxiety <- as.numeric(asdsocanx)
asdschanx <- dplyr::pull(ASD, 11)
ASDschoolanxiety <- as.numeric(asdschanx)
asdtotalscared <- dplyr::pull(ASD, 12)
ASDtotalscared <- as.numeric(asdtotalscared)
asdadmir <- dplyr::pull(ASD, 13)
ASDadmiration <- as.numeric(asdadmir)
asdnsp <- dplyr::pull(ASD, 14)
ASDnegativesocialpotency <- as.numeric(asdnsp)
asdpass <- dplyr::pull(ASD, 15)
ASDpassivity <- as.numeric(asdpass)
asdpro <- dplyr::pull(ASD, 16)
ASDprosocial <- as.numeric(asdpro)
asdsoc <- dplyr::pull(ASD, 17)
ASDsociability <- as.numeric(asdsoc)
asdpsp <- dplyr::pull(ASD, 18)
ASDparentSP <- as.numeric(asdpsp)
asdpga <- dplyr::pull(ASD, 19)
ASDparentGA <- as.numeric(asdpga)
asdpsepanx <-dplyr::pull(ASD, 20)
ASDparentSEPANX <- as.numeric(asdpsepanx)
asdpsocanx <- dplyr::pull(ASD, 21)
ASDparentSOCANX <- as.numeric(asdpsocanx)
asdpschanx <- dplyr::pull(ASD, 22)
ASDparentSCHANX <- as.numeric(asdpschanx)
asdparenttotalscared <- dplyr::pull(ASD, 23)
ASDtotalparentscared <- as.numeric(asdparenttotalscared)
asdad <- dplyr::pull(ASD, 24)
ASDanxiousdepressed <- as.numeric(asdad)
asdwd <- dplyr::pull(ASD, 25)
ASDwithdrawndepressed <- as.numeric(asdwd)
asdsc <- dplyr::pull(ASD, 26)
ASDsomaticcomplaints <- as.numeric(asdsc)
asdis <- dplyr::pull(ASD, 27)
ASDinternalizingscore <- as.numeric(asdis)
library(psych)
library(ggplot2)
library(ggthemes)
library(rstatix)
t.test(TDloneliness,ASDloneliness)
lonely <- lm(formula = loneliness ~ age + group + age:group, data=data)
summary(lonely)
summary(ASDloneliness)
summary(TDloneliness)
lonely2 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore, data=data)
summary(lonely2)
ggplot(data, aes(x=dissimilarity, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("dissimilarity")+ylab("loneliness")+ggtitle("dissimilarity and loneliness")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
lonely3 <- lm(formula = loneliness ~ srqAdmiration + srqProsocialInteraction + srqSociability, data=data)
summary(lonely3)
exam10 <- lm(formula = cbind(srqNegativeSocialPotency,srqPassivity) ~ childtotalscared + parenttotalscared + internalizingscore + lonliness + age, data=ASD)
summary(exam10)
exam10 <- lm(formula = cbind(srqNegativeSocialPotency,srqPassivity) ~ childtotalscared + parenttotalscared + internalizingscore + loneliness + age, data=ASD)
summary(exam10)
lonely2 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore, data=data)
summary(lonely2)
lonely3 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore, data=ASD)
summary(lonely3)
lonely4 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore, data=TD)
summary(lonely4)
lonely5 <- lm(formula = loneliness ~ dissimilarity + group, data=data)
summary(lonely5)
lonely3 <- lm(formula = loneliness ~ dissimilarity, data=ASD)
summary(lonely3)
lonely4 <- lm(formula = loneliness ~ dissimilarity, data=TD)
summary(lonely4)
lonely2 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore, data=data)
summary(lonely2)
lonely5 <- lm(formula = loneliness ~ dissimilarity + group + sex + age, data=data)
summary(lonely5)
ggplot(ASD, aes(x=dissimilarity, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("dissimilarity")+ylab("loneliness")+ggtitle("dissimilarity and loneliness")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
ggplot(ASD, aes(x=dissimilarity, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Perceived dissimilarity")+ylab("Self-report of loneliness")+ggtitle("Dissimilarity and Loneliness in autistic adolescents")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
ggplot(ASD, aes(x=dissimilarity, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Perceived dissimilarity")+ylab("Self-report of loneliness")+ggtitle("Dissimilarity and loneliness in autistic adolescents")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
lonely3 <- lm(formula = loneliness ~ dissimilarity + age, data=ASD)
summary(lonely3)
exam9 <- lm(formula = cbind(childtotalscared,parenttotalscared,internalizingscore) ~ loneliness + age + group + sex + age:group, data=data)
exam16 <- lm(formula = cbind(childtotalscared,parenttotalscared,internalizingscore) ~ loneliness + age + group + sex + age:group, data=data)
summary(exam16)
exam6 <- lm(formula = childtotalscared ~ age, data=TD)
summary(exam6)
lonely4 <- lm(formula = loneliness ~ dissimilarity, data=TD)
summary(lonely4)
lonely3 <- lm(formula = loneliness ~ dissimilarity + age, data=ASD)
summary(lonely3)
lonely3 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age, data=ASD)
summary(lonely3)
ggplot(ASD, aes(x=dissimilarity, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Perceived dissimilarity")+ylab("Self-report of loneliness")+ggtitle("Dissimilarity and loneliness in autistic children")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
lonely3 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age, data=ASD)
summary(lonely3)
lonely7 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age, data=TD)
summary(lonely7)
ggplot(TD, aes(x=parenttotalscared, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Parent SCARED")+ylab("Self-report of loneliness")+ggtitle("Dissimilarity and loneliness in autistic children")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
lonely3 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age +sex , data=ASD)
summary(lonely3)
lonely7 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age + sex, data=TD)
summary(lonely7)
ggplot(TD, aes(x=parenttotalscared, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Parent SCARED")+ylab("Self-report of loneliness")+ggtitle("Parent-report SCAreD and loneliness in neurotypical children")+theme(axis.title=element_text(size=10),plot.title=element_text(size=10))
ggplot(TD, aes(x=parenttotalscared, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Parent SCARED")+ylab("Self-report of loneliness")+ggtitle("Parent-report SCARED and loneliness in neurotypical children")+theme(axis.title=element_text(size=10),plot.title=element_text(size=8))
ggplot(TD, aes(x=parenttotalscared, y=loneliness))+geom_point(color="paleturquoise3")+geom_smooth(method="lm", color="black")+xlab("Parent SCARED total")+ylab("Self-report of loneliness")+ggtitle("Parent-report SCARED and loneliness in neurotypical children")+theme(axis.title=element_text(size=10),plot.title=element_text(size=8))
res <- cor.test(data$parenttotalscared, data$internalizingscore, method = "pearson")
summary(res)
res
plot(data$parenttotalscared, data$internalizingscore)
res2 <- cor.test(data$childtotalscared, data$internalizingscore, method = "pearson")
res2
plot(data$childtotalscared, data$internalizingscore)
lonely6 <- lm(formula = loneliness ~ dissimilarity + internalizingscore + age +sex , data=ASD)
summary(lonely6)
lonely8 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + age + sex, data=TD)
summary(lonely8)
lonely6 <- lm(formula = loneliness ~ dissimilarity + internalizingscore + age +sex , data=ASD)
summary(lonely6)
lonely8 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + age + sex, data=ASD)
summary(lonely8)
lonely9 <- lm(formula = loneliness ~ dissimilarity + internalizingscore + age +sex , data=TD)
summary(lonely9)
lonely10 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + age + sex, data=TD)
summary(lonely10)
res <- cor.test(data$parenttotalscared, data$internalizingscore, method = "pearson")
res
cor(data$parenttotalscared, data$internalizingscore)
cor(data$childtotalscared, data$internalizingscore)
install.packages("car")
vif(data$parenttotalscared, data$internalizingscore)
VIF(data$parenttotalscared, data$internalizingscore)
install.packages("car")
install.packages("car")
VIF(data$parenttotalscared, data$internalizingscore)
library(car)
VIF(data$parenttotalscared, data$internalizingscore)
vif(data$parenttotalscared, data$internalizingscore)
vif(parenttotalscared, internalizingscore)
vif(res)
res <- cor.test(data$parenttotalscared, data$internalizingscore, method = "pearson")
vif(res)
test <- cor(data$parenttotalscared, data$internalizingscore)
vif(test)
new <- data[ , c("parenttotalscared", "childtotalscared", "internalizingscore")]
cor(new)
vif(lonely8)
model <- cor(data$childtotalscared, data$internalizingscore)
vif(model)
vif(lonely10)
vif(lonely3)
vif(lonely7)
lonely2 <- lm(formula = loneliness ~ dissimilarity + childtotalscared + parenttotalscared + internalizingscore + age + sex + group, data=data)
summary(lonely2)
View(lonely9)
library(tidyverse)
library(dplyr)
setwd("/Volumes/research$/redcay/DSCN Lab/Experiments/SCONN/Social Reward fMRI answers/Pre and post data")
df <- read.csv("SCN_prepost.csv")
View(df)
Split_based_on_group <- split(df, with(df, interaction(whichissim)), drop = TRUE)
peer1sim <- Split_based_on_group[[1]]
peer2sim <- Split_based_on_group[[2]]
peer1sim <- peer1sim[-c(8,19:27)]
peer2sim <- peer2sim[-c(8,19:27)]
col_order <- c("record_id","pre2","pre1","pre4","pre3","pre6","pre5","post2","post1","post4","post3","post6","post5","post8","post7","post9","post10")
order2 <- peer2sim[,col_order]
colnames(peer1sim) <- c("record_id","presim1","predis1","presim2","predis2","presim3","predis3","postsim1","postdis1","postsim2","postdis2","postsim3","postdis3",
"postsim4","postdis4","postcomp","postwhomost")
colnames(order2) <- c("record_id","presim1","predis1","presim2","predis2","presim3","predis3","postsim1","postdis1","postsim2","postdis2","postsim3","postdis3",
"postsim4","postdis4","postcomp","postwhomost")
finalorder2 <- order2 %>%
mutate(postwhomost = case_when(postwhomost == '1' ~ '2',
postwhomost == '2' ~ '1',
postwhomost == '3' ~ '3'))
combine <- rbind(peer1sim,finalorder2)
write.csv(combine,'/Volumes/research$/redcay/DSCN Lab/Experiments/SCONN/Social Reward fMRI answers/Pre and post data/correctorder.csv', row.names = FALSE)
